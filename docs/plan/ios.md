# План: ios

**Назначение:** SwiftUI SPM-пакет **nahui3**: загрузка фичи, передача версии, применение дельты, рендер по манифесту и файлам.

## Контекст

- Фича описывается манифестом (дерево папок и файлов с id, name, hash). Узел (файл в фиче): **id** (UUID от пути), **name** (имя файла), **hash** (content-hash). Иерархия задаётся манифестом.
- Клиент передаёт версию и идентификатор фичи; сервер достаёт манифесты двух версий (переданной и опубликованной), сравнивает, строит или достаёт из кеша дельту и отправляет клиенту **дельту вместе с опубликованным манифестом** (либо «изменений не было»).

## Задачи

1. **Модели данных**
   - Модели манифеста и узла: **id** (UUID), **name** (имя файла), **hash** (content-hash); дерево папок и файлов по манифесту. Модель дельты (набор операций над файлами/узлами), приходящей с сервера.

2. **Сеть и кеш**
   - Запрос фичи: платформа, id фичи, версия (передаваемая клиентом). Разбор ответа: **дельта + опубликованный манифест** (или «изменений не было»). Локальный кеш манифеста и состояния фичи для офлайна и быстрого старта.

3. **Применение дельты**
   - При получении дельты и опубликованного манифеста — применение дельты к предыдущему состоянию, кеширование опубликованного манифеста. Обновление локального дерева (добавление, изменение, удаление узлов по id/пути). Перерисовка UI по манифесту и содержимому файлов.

4. **Рендер по манифесту и файлам**
   - Интерпретация манифеста и содержимого файлов фичи для построения SwiftUI-вью (аналог рендера по описанию).

5. **Документация и тесты**
   - README, примеры использования в demo; юнит-тесты парсинга манифеста и применения дельты.

## Результат

iOS-приложение (demo) подключает SPM-пакет nahui3, передаёт версию и id фичи, получает дельту и опубликованный манифест, применяет дельту, кеширует манифест и рендерит.
